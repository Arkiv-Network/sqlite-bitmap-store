// Code generated by sqlc. DO NOT EDIT.
// versions:
//   sqlc v1.30.0
// source: queries.sql

package store

import (
	"context"
)

const deleteNumericAttributeValueBitmap = `-- name: DeleteNumericAttributeValueBitmap :exec
DELETE FROM numeric_attributes_values_bitmaps
WHERE name = ? AND value = ?
`

type DeleteNumericAttributeValueBitmapParams struct {
	Name  string
	Value uint64
}

func (q *Queries) DeleteNumericAttributeValueBitmap(ctx context.Context, arg DeleteNumericAttributeValueBitmapParams) error {
	_, err := q.exec(ctx, q.deleteNumericAttributeValueBitmapStmt, deleteNumericAttributeValueBitmap, arg.Name, arg.Value)
	return err
}

const deletePayloadForEntityKey = `-- name: DeletePayloadForEntityKey :exec
DELETE FROM payloads
WHERE entity_key = ?
`

func (q *Queries) DeletePayloadForEntityKey(ctx context.Context, entityKey []byte) error {
	_, err := q.exec(ctx, q.deletePayloadForEntityKeyStmt, deletePayloadForEntityKey, entityKey)
	return err
}

const deleteStringAttributeValueBitmap = `-- name: DeleteStringAttributeValueBitmap :exec
DELETE FROM string_attributes_values_bitmaps
WHERE name = ? AND value = ?
`

type DeleteStringAttributeValueBitmapParams struct {
	Name  string
	Value string
}

func (q *Queries) DeleteStringAttributeValueBitmap(ctx context.Context, arg DeleteStringAttributeValueBitmapParams) error {
	_, err := q.exec(ctx, q.deleteStringAttributeValueBitmapStmt, deleteStringAttributeValueBitmap, arg.Name, arg.Value)
	return err
}

const getLastBlock = `-- name: GetLastBlock :one
SELECT block FROM last_block
`

func (q *Queries) GetLastBlock(ctx context.Context) (int64, error) {
	row := q.queryRow(ctx, q.getLastBlockStmt, getLastBlock)
	var block int64
	err := row.Scan(&block)
	return block, err
}

const getNumericAttributeValueBitmap = `-- name: GetNumericAttributeValueBitmap :one
SELECT bitmap FROM numeric_attributes_values_bitmaps
WHERE name = ? AND value = ?
`

type GetNumericAttributeValueBitmapParams struct {
	Name  string
	Value uint64
}

func (q *Queries) GetNumericAttributeValueBitmap(ctx context.Context, arg GetNumericAttributeValueBitmapParams) (*Bitmap, error) {
	row := q.queryRow(ctx, q.getNumericAttributeValueBitmapStmt, getNumericAttributeValueBitmap, arg.Name, arg.Value)
	var bitmap *Bitmap
	err := row.Scan(&bitmap)
	return bitmap, err
}

const getPayloadForEntityKey = `-- name: GetPayloadForEntityKey :one
SELECT entity_key, id, payload, content_type, string_attributes, numeric_attributes
FROM payloads
WHERE entity_key = ?
`

type GetPayloadForEntityKeyRow struct {
	EntityKey         []byte
	ID                uint64
	Payload           []byte
	ContentType       string
	StringAttributes  string
	NumericAttributes string
}

func (q *Queries) GetPayloadForEntityKey(ctx context.Context, entityKey []byte) (GetPayloadForEntityKeyRow, error) {
	row := q.queryRow(ctx, q.getPayloadForEntityKeyStmt, getPayloadForEntityKey, entityKey)
	var i GetPayloadForEntityKeyRow
	err := row.Scan(
		&i.EntityKey,
		&i.ID,
		&i.Payload,
		&i.ContentType,
		&i.StringAttributes,
		&i.NumericAttributes,
	)
	return i, err
}

const getStringAttributeValueBitmap = `-- name: GetStringAttributeValueBitmap :one
SELECT bitmap FROM string_attributes_values_bitmaps
WHERE name = ? AND value = ?
`

type GetStringAttributeValueBitmapParams struct {
	Name  string
	Value string
}

func (q *Queries) GetStringAttributeValueBitmap(ctx context.Context, arg GetStringAttributeValueBitmapParams) (*Bitmap, error) {
	row := q.queryRow(ctx, q.getStringAttributeValueBitmapStmt, getStringAttributeValueBitmap, arg.Name, arg.Value)
	var bitmap *Bitmap
	err := row.Scan(&bitmap)
	return bitmap, err
}

const upsertLastBlock = `-- name: UpsertLastBlock :exec
INSERT INTO last_block (id, block)
VALUES (1, ?)
ON CONFLICT (id) DO UPDATE SET block = EXCLUDED.block
`

func (q *Queries) UpsertLastBlock(ctx context.Context, block int64) error {
	_, err := q.exec(ctx, q.upsertLastBlockStmt, upsertLastBlock, block)
	return err
}

const upsertNumericAttributeValueBitmap = `-- name: UpsertNumericAttributeValueBitmap :exec
INSERT INTO numeric_attributes_values_bitmaps (name, value, bitmap)
VALUES (?, ?, ?)
ON CONFLICT (name, value) DO UPDATE SET bitmap = excluded.bitmap
`

type UpsertNumericAttributeValueBitmapParams struct {
	Name   string
	Value  uint64
	Bitmap *Bitmap
}

func (q *Queries) UpsertNumericAttributeValueBitmap(ctx context.Context, arg UpsertNumericAttributeValueBitmapParams) error {
	_, err := q.exec(ctx, q.upsertNumericAttributeValueBitmapStmt, upsertNumericAttributeValueBitmap, arg.Name, arg.Value, arg.Bitmap)
	return err
}

const upsertPayload = `-- name: UpsertPayload :one
INSERT INTO payloads (
    entity_key,
    payload,
    content_type,
    string_attributes,
    numeric_attributes
) VALUES (?, ?, ?, ?, ?)
ON CONFLICT (entity_key) DO UPDATE SET
    payload = excluded.payload,
    content_type = excluded.content_type,
    string_attributes = excluded.string_attributes,
    numeric_attributes = excluded.numeric_attributes
RETURNING id
`

type UpsertPayloadParams struct {
	EntityKey         []byte
	Payload           []byte
	ContentType       string
	StringAttributes  string
	NumericAttributes string
}

func (q *Queries) UpsertPayload(ctx context.Context, arg UpsertPayloadParams) (uint64, error) {
	row := q.queryRow(ctx, q.upsertPayloadStmt, upsertPayload,
		arg.EntityKey,
		arg.Payload,
		arg.ContentType,
		arg.StringAttributes,
		arg.NumericAttributes,
	)
	var id uint64
	err := row.Scan(&id)
	return id, err
}

const upsertStringAttributeValueBitmap = `-- name: UpsertStringAttributeValueBitmap :exec
INSERT INTO string_attributes_values_bitmaps (name, value, bitmap)
VALUES (?, ?, ?)
ON CONFLICT (name, value) DO UPDATE SET bitmap = excluded.bitmap
`

type UpsertStringAttributeValueBitmapParams struct {
	Name   string
	Value  string
	Bitmap *Bitmap
}

func (q *Queries) UpsertStringAttributeValueBitmap(ctx context.Context, arg UpsertStringAttributeValueBitmapParams) error {
	_, err := q.exec(ctx, q.upsertStringAttributeValueBitmapStmt, upsertStringAttributeValueBitmap, arg.Name, arg.Value, arg.Bitmap)
	return err
}
